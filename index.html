<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ChatHOO GPT</title>
  <style>
    body { font-family: 'Noto Sans KR', sans-serif; background: #f5f5f5; margin: 0; padding: 20px; }
    .chat-box { max-width: 600px; margin: 0 auto; background: #fff; border-radius: 10px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    .message { display: flex; margin: 10px 0; }
    .user { background: #ffeb3b; padding: 10px 14px; border-radius: 18px; margin-left: auto; }
    .bot { background: #e0e0e0; padding: 10px 14px; border-radius: 18px; margin-right: auto; }
    .input-area { display: flex; margin-top: 20px; }
    input { flex: 1; padding: 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 16px; }
    button { background: #333; color: #fff; border: none; padding: 10px 20px; margin-left: 10px; border-radius: 6px; cursor: pointer; }
  </style>
</head>
<body>
  <div class="chat-box" id="chat"></div>
  <div class="input-area">
    <input id="input" placeholder="메시지를 입력하세요.">
    <button onclick="send()">전송</button>
  </div>

  <script>
    const endpoint = 'https://script.google.com/macros/s/AKfycbylXTyToDQZO1ZlfQGyOeFW3z7i7SCOtM8YH7-PaLm6Em8U_44L0gyg26QlrbPYCr9BGg/exec';

    function appendMessage(content, type) {
      const div = document.createElement('div');
      div.className = 'message ' + (type === 'user' ? 'user' : 'bot');
      div.innerText = content;
      document.getElementById('chat').appendChild(div);
    }

    async function send() {
      const input = document.getElementById('input').value;
      if (!input) return;
      appendMessage(input, 'user');
      document.getElementById('input').value = '';

      appendMessage('⏳ 생각 중...', 'bot');

      try {
        const response = await fetch(endpoint, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ input })
        });

        const data = await response.json();
        document.querySelectorAll('.bot').pop().remove();
        appendMessage(data.choices[0].message.content, 'bot');

      } catch (err) {
const bots = document.querySelectorAll('.bot');
if (bots.length) bots[bots.length - 1].remove();

        appendMessage("❌ 오류 발생: " + err.message, 'bot');
      }
    }
  </script>
</body>
</html>
